<%# Copied from ArcLight core in order to customize locally, especially %>
<%# setting default group by collection. Last checked for updates:      %>
<%# ArcLight v0.3.0. %>
<%# https://github.com/projectblacklight/arclight/blob/master/app/views/catalog/_search_form.html.erb #%>

<%= form_tag search_action_url, method: :get, class: 'search-query-form pr-0 flex-fill', role: 'search' do %>
  <%= render_hash_as_hidden_fields(search_state.params_for_search.except(:q, :search_field, :qt, :page, :utf8).merge(f: (search_state.params_for_search[:f] || {}).except(:collection_sim))) %>
  <%# DUL CUSTOMIZATION: default to group by collection %>
  
  <%= hidden_field_tag :group, 'true' %>

  <div class="d-md-flex">
    
    <div class="input-group flex-nowrap">
      
      <%# select options %>
      <%= render 'catalog/within_collection_dropdown' %>

      <%# text input %>
      <div class="text-input-wrapper">
        <label for="q" class="sr-only"><%= t('blacklight.search.form.search.label') %></label>
        <%= text_field_tag :q, params[:q], placeholder: t('blacklight.search.form.search.placeholder'), class: "search-q q form-control", id: "q", autofocus: presenter.autofocus?, data: { autocomplete_enabled: presenter.autocomplete_enabled?, autocomplete_path: search_action_path(action: :suggest) }  %>
      </div>
      
      <%# search btn -%>
      <div class="input-group-append">
        <button type="submit" class="btn btn-primary search-btn" id="search">
          <span class="submit-search-text d-none d-lg-inline sr-only"><%= t('blacklight.search.form.submit') %></span>
          <i class="fas fa-search"></i>
        </button>
      </div>

    </div>
  </div>
<% end %>

<%# advanced search link and bookmarks button %>
<div class="search-extra-controls flex-fill">  
  <div class='input-group'>   
    
    <%# define this in a controller? %>
    <a class="advanced_search" href="/advanced">Advanced Search</a>

    <%= link_to bookmarks_path, id:'bookmarks_nav' do %>
      <i class="fas fa-bookmark"></i> <span class="bookmarks-label"><%= t('blacklight.header_links.bookmarks') %></span>
      <span class="open-paren">(</span><span data-role='bookmark-counter'><%= current_or_guest_user.bookmarks.count %></span><span class="close-paren">)</span>
    <% end %>
  
  </div>       
</div>
